<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8"/>
        <meta name="viewport" content="width=device-width,user-scalable=no"/>
        <link rel="meta" type="application/rdf+xml" href="rdf.xml"/>
        <link rel="icon" type="image/png" href="images/icon-16.png"/>
        <title>Coords - socket.io test</title>
        <link rel="stylesheet" href="bower_components/bootstrap/dist/css/bootstrap.css"/>
        <link rel="stylesheet" href="bower_components/lato/css/lato.css"/>

        <link rel="stylesheet" href="stylesheets/messenger.css"/>
        <link rel="stylesheet" href="stylesheets/ui.css"/>

    </head>
    <body>
        <div class="container">
            <div class="row rooms">
                <div class="col-xs-4 room room-1">
                    <form class="form-inline">
                        <div class="form-group">
                            <div class="input-group">
                                <div class="input-group-addon">Room Name:</div>
                                <input type="text" class="form-control room_name" placeholder="name..."/>
                            </div>
                        </div>
                        <button type="submit" class="btn btn-primary">Set room</button>
                    </form>
                    <div class="messenger">
                        <div class="messenger-messages">
                            <div class="messenger-message messenger-message-user-other">
                                <div class="messenger-message-user">
                                    <img src="https://avatars0.githubusercontent.com/u/757713?v=3&amp;s=40"/>
                                </div>
                                <div class="messenger-message-content">
                                    Hello World
                                </div>
                            </div>
                            <div class="messenger-message messenger-message-user-me">
                                <div class="messenger-message-content">
                                    This is just a test.
                                </div>
                            </div>
                        </div>
                        <div class="messenger-compose">
                            <textarea class="messenger-compose-text"></textarea>
                            <button type="submit" class="btn btn-primary messenger-compose-send">Send</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <script src="bower_components/jquery/dist/jquery.js"></script>
        <script src="bower_components/bootstrap/dist/js/bootstrap.js"></script>
        <script src="bower_components/socket.io-client/socket.io.js"></script>

        <script src="javascripts/NativeWrapper.js"></script>
        <script src="javascripts/CoordsLog.js"></script>
        <script src="javascripts/CoordsComms.js"></script>
        <script>

            $(document).ready(function(){

                CoordsComms.init();

                var chat_copy = $(".room-1").clone(false);
                $(chat_copy).removeClass("room-1");
                $(chat_copy).addClass("room-2");
                $(".rooms").append(chat_copy);
                var chat_copy = $(".room-1").clone(false);
                $(chat_copy).removeClass("room-1");
                $(chat_copy).addClass("room-3");
                $(".rooms").append(chat_copy);

                $(".messenger-compose-send").click(function(){
                    var room = $(this).closest(".room");
                    var room_id = $.grep($(this).closest(".room").attr("class").split(' '),function( o ){
                        var re = /(room-[0-9]+)/g;
                        if(re.exec(o)!=null){
                            return o;
                        }
                    })[0];
                    var room_name = room.find(".room_name").val();
                    console.log(room_name);
                });
            });
        </script>
    </body>
</html>