<!DOCTYPE html>
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,user-scalable=no"/>
    <link rel="meta" type="application/rdf+xml" href="rdf.xml"/>
    <link rel="icon" type="image/png" href="images/icon-16.png"/>
    <title>Coords - rooms test</title>
    <link rel="stylesheet" href="bower_components/bootstrap/dist/css/bootstrap.css"/>
    <link rel="stylesheet" href="bower_components/lato/css/lato.css"/>

    <link rel="stylesheet" href="stylesheets/messenger.css"/>
    <link rel="stylesheet" href="stylesheets/ui.css"/>
</head>
<html>
    <body>
        <form class="form room-create">
            <div class="form-group">
                <div class="input-group">
                    <div class="input-group-addon">Room Name</div>
                    <input type="text" class="form-control room-name"/>
                </div>
                <div class="input-group">
                    <label>Private:
                        <input type="checkbox" class="room-private">
                    </label>
                </div>
                <div class="input-group">
                    <div class="input-group-addon">Passphrase</div>
                    <input type="password" class="form-control room-passphrase"/>
                </div>
                <div class="input-group">
                    <div class="input-group-addon">Latitude</div>
                    <input type="number" class="form-control room-latitude"/>
                </div>
                <div class="input-group">
                    <div class="input-group-addon">Longitude</div>
                    <input type="number" class="form-control room-longitude"/>
                </div>
            </div>
        </form>
        <button type="submit" class="btn btn-primary room-create-button">Create Room</button>
        <hr>
        <button class="btn btn-primary room-update-button">Update Room</button>
        <hr>
        <button class="btn btn-primary room-read-button">Read Room</button>
        <hr>
        <button class="btn btn-primary room-delete-button">Delete Room</button>

        <script src="bower_components/jquery/dist/jquery.js"></script>
        <script src="bower_components/bootstrap/dist/js/bootstrap.js"></script>
        <script src="bower_components/socket.io-client/socket.io.js"></script>

        <script src="javascripts/NativeWrapper.js"></script>
        <script src="javascripts/CoordsLog.js"></script>
        <script src="javascripts/CoordsRooms.js"></script>
        <script>
            $(".room-create-button").click(function(){
                var room_create = $(".room-create");
                room = {};
                room.name = $(room_create).find(".room-name").val();
                room.private = $(room_create).find(".room-private").is(':checked');
                room.passphrase = $(room_create).find(".room-passphrase").val();
                if(room.passphrase.length==0)
                    delete room.passphrase;
                room.latitude = parseFloat($(room_create).find(".room-latitude").val());
                room.longitude = parseFloat($(room_create).find(".room-longitude").val());
                console.log(room);
                $.ajax({
                    type: "POST",
                    url: "rooms/create",
                    data: JSON.stringify(room),
                    contentType: "application/json",
                    dataType: "json",
                    success: function (msg) {
                        console.log(data)
                    },
                    error:function(x,e){
                        if(x.status==0){
                            alert('error 0');
                        }
                    }
                });
            });

            $.ajax({
                type: "GET",
                url: "rooms/nearby/55.91153932483637/-3.3208322525024414/1000/10/0",
                contentType: "application/json",
                dataType: "json",
                success: function (msg) {
                    console.log(msg)
                },
                error:function(x,e){
                    if(x.status==0){
                        alert('error 0');
                    }
                }
            });

            var query = {
                'roomId': '54ea531cefac2bd6717ceb5e',
                'passphrase':'hello'
            }
            function joinRoom(roomId){
                $.ajax({
                    type: "POST",
                    url: "rooms/join",
                    data: JSON.stringify({
                        'roomId': '54ea531cefac2bd6717ceb5e',
                        'passphrase':'hello'
                    }),
                    contentType: "application/json",
                    dataType: "json",
                    success: function (msg) {
                        console.log(data)
                    },
                    error:function(x,e){
                        if(x.status==0){
                            alert('error 0');
                        }
                    }
                });
            }
            function joinPasswordRoom(roomId){
                $.ajax({
                    type: "POST",
                    url: "rooms/join",
                    data: JSON.stringify({
                        'roomId': '54ea5390efac2bd6717ceb61',
                        'passphrase':'lalalal'
                    }),
                    contentType: "application/json",
                    dataType: "json",
                    success: function (msg) {
                        console.log(data)
                    },
                    error:function(x,e){
                        if(x.status==0){
                            alert('error 0');
                        }
                    }
                });
            }
            function leaveRoom(roomId){
                $.ajax({
                    type: "POST",
                    url: "rooms/leave",
                    data: JSON.stringify({
                        'roomId': '54ea531cefac2bd6717ceb5e'
                    }),
                    contentType: "application/json",
                    dataType: "json",
                    success: function (msg) {
                        console.log(data)
                    },
                    error:function(x,e){
                        if(x.status==0){
                            alert('error 0');
                        }
                    }
                });
            }
        </script>
    </body>
</html>